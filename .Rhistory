labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
theme_bw()
#plot
ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
theme_bw()
#plot
ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
#geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
theme_bw()
#plot
ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
theme_bw()
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
theme_bw()
pdf("figures/volume_test_DNA_conc.pdf", width = 8, height = 6)
p1
dev.off()
pdf("figures/volume_test_DNA_conc.pdf", width = 6, height = 4)
p1
dev.off()
source("R_scripts/ggplot_teheme.txt")
source("R_scripts/ggplot_theme.txt")
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme
p1
pdf("figures/volume_test_DNA_conc.pdf", width = 6, height = 4)
p1
dev.off()
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 10)
)
p1
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 12)
)
p1
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
p1
pdf("figures/volume_test_DNA_conc.pdf", width = 8, height = 6)
p1
dev.off()
anova(mod1)
q(save="no")
?rnorm
1:100
data.df = data.frame(year = 1:50, N = rnorm(50))
data.df
plot(N ~ year, data = data.df)
mod1 = lm(N ~ year, data = data.df)
summary(mod1)
anova(mod1)
?cor
cor(data.df$N, data.df$year)
cor.test(data.df$N, data.df$year)
ggplot(data.df, aes(x = year, y = N)) +
geom_point() +
geom_smooth(method = "lm") +
theme_bw()
library(ggplot2)
ggplot(data.df, aes(x = year, y = N)) +
geom_point() +
geom_smooth(method = "lm") +
theme_bw()
?cor.test
q(save="no")
q(save="no")
library(dplyr)
library(ggplot2)
library(RColorBrewer)
source("R_scripts/ggplot_theme.txt")
conc = read.csv("data/volume_test_qubit_01022023.csv")
head(conc)
conc %>% filter(volume == "blank")
conc = conc %>% filter(volume != "blank")
conc$ID = paste(conc$site, conc$date, sep = " ")
conc$volume = as.numeric(conc$volume)
str(conc)
mod1 = lm(concentration ~ ID + volume, data = conc)
mod1
summary(mod1)
anova(mod1)
mod2 = lm(concentration ~ ID * volume, data = conc)
mod2
summary(mod2)
anova(mod2)
#no significant interaction
anova(mod1, mod2)
summary(mod1)
anova(mod1)
mod3 = lm(concentration ~ ID/volume, data = conc)
summary(mod3)
anova(mod3)
cor(conc[c("concentration", "volume")])
cor.test(conc$volume, conc$concentration)
plot(conc$volume ~ conc$concentration)
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
p1
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
#geom_smooth(method = "lm", se = F) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
p1
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration)) +
geom_smooth(method = "lm", se = F) +
geom_point(
size = 2, position = position_jitter(width = 0.5, height = 0),
aes(color = ID)
) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
p1
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration)) +
geom_smooth(method = "lm", color = "black") +
geom_point(
size = 2, position = position_jitter(width = 0.5, height = 0),
aes(color = ID)
) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
p1
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration)) +
geom_smooth(method = "lm") +
geom_point(
size = 2, position = position_jitter(width = 0.5, height = 0),
aes(color = ID)
) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
p1
anova(mod1)
sum(6708.0, 1184.1, 3122.3)
1184.1/sum(6708.0, 1184.1, 3122.3)
6708.0/sum(6708.0, 1184.1, 3122.3)
summary(mod2)
summary(mod1)
anova(mod1)
summary(mod2)
anova(mod2)
summary(mod2)
summary(mod1)
6708.0/sum(6708.0, 1184.1, 3122.3)
?geom_smooth
#add regression lines to the df based on the best model
conc = cbind(conc, pred = predict(mod1))
conc
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
#plot
p1 = ggplot(conc, aes(x = volume, y = concentration, color = ID)) +
#geom_smooth(method = "lm", se = F, formula = ) +
geom_line(mapping=aes(y=pred)) +
geom_point(size = 2, position = position_jitter(width = 0.5, height = 0)) +
scale_color_brewer(palette = "Paired") +
scale_x_continuous(breaks = c(5,10,20,40,80)) +
labs(
y = expression(paste("DNA concentration (ng ",mu,"l"^-1,")")),
x = "Volume trap fluid (ml)"
) +
my_gg_theme +
theme(
legend.text = element_text(size = 15)
)
p1
pdf("figures/volume_test_DNA_conc.same_slope.pdf", width = 8, height = 6)
p1
dev.off()
anova(mod1)
1184.1/sum(6708.0, 1184.1, 3122.3)
mod4 = aov(concentration ~ ID + volume, data = conc)
summary(mod4)
1184.1/sum(6708.0, 1184.1, 3122.3)
6708.0/sum(6708.0, 1184.1, 3122.3)
anova(mod4)
summary(mod4)
cor.test(conc$volume, conc$concentration)
mod4 = aov(concentration ~ ID, data = conc)
summary(mod4)
mod4 = lm(concentration ~ ID, data = conc)
summary(mod4)
summary(mod1)
0.7165-0.609
mod5 = lm(concentration ~ volume, data = conc)
summary(mod5)
summary(mod1)
0.7165-0.1025
saturating_fun = function(x, m, h){
y = m * (x/(x+h))
return(y)
}
saturating_fun(vols, 80, 20)
vols = c(5,10,20,40,80)
saturating_fun(vols, 80, 20)
spp_num = saturating_fun(vols, 80, 20)
plot(spp_num ~ vols)
spp_num = saturating_fun(vols, 60, 20)
plot(spp_num ~ vols)
spp_num = saturating_fun(vols, 60, 15)
plot(spp_num ~ vols)
spp_num = saturating_fun(vols, 40, 15)
plot(spp_num ~ vols)
spp_num = saturating_fun(vols, 40, 10)
plot(spp_num ~ vols)
spp_num = saturating_fun(vols, 30, 10)
plot(spp_num ~ vols)
spp_num = saturating_fun(vols, 40, 10)
plot(spp_num ~ vols)
cbind(vols, spp_num)
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_point() +
geom_smooth()
warnings()
spp_num = saturating_fun(vols, 20, 5)
plot(spp_num ~ vols)
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_point() +
geom_smooth()
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_point() +
geom_smooth() +
theme_bw()
spp_num = saturating_fun(vols, 10, 2.5)
plot(spp_num ~ vols)
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_point() +
geom_smooth() +
theme_bw()
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_point() +
geom_smooth(coilor = "dark grey") +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_point() +
geom_smooth(color = "dark grey") +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "dark grey") +
geom_point(size = 3) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "dark grey") +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "black") +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
spp_num
spp_num = saturating_fun(vols*10, 10, 2.5)
spp_num
spp_num = saturating_fun(vols*10, 20, 5)
plot(spp_num ~ vols)
spp_num
spp_num = c(50, 100, 150, 175, 175)
plot(spp_num ~ vols)
spp_num = c(50, 100, 150, 175, 180)
plot(spp_num ~ vols)
ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "black") +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
p1 = ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "black") +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
pdf("figures/accumulation_curve_example.pdf")
p1
dev.off()
source("~/repo/BIL_pathogens/R_scripts/soo_accumulation_cirve_example.R", echo=TRUE)
p1
p1 = ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "black", method = "lm", formula = y ~ poly(x, 2), se = F) +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
p1
p1 = ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "black") +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
p1
p1 = ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_line(color = "black") +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
p1
smooth
p1 = ggplot(data.frame(vols, spp_num), aes(vols, spp_num)) +
geom_smooth(color = "black") +
geom_point(size = 2) +
theme_bw() +
labs(x = "Volume fluid (ml)", y = "Number species")
p1
pdf("figures/accumulation_curve_example.pdf")
p1
dev.off()
pdf("figures/accumulation_curve_example.pdf", width = 6, height = 4)
p1
dev.off()
q(save="no")
library(dplyr)
lens = read.table("all.lens.txt")
lens = read.table("vol_test/all.lens.txt")
lens = read.table("data/vol_test/all.lens.txt")
lens_mod = read.table("data/vol_test/all_mod.lens.txt")
comb_lens = left_join(lens, lens_mod, by = "V1")
head(comb_lens)
plot(V2.x ~ V2.y, data = comb_lens)
library(ggplot2)
ggplot(comb_lens, aes(V2.x V2,y)) +
ggplot(comb_lens, aes(V2.x, V2.y)) +
geom_point()
lens_r1 = read.table("data/vol_test/itsx_test/R1.lens.txt")
lens_mod = read.table("data/vol_test/itsx_mod_test/R1.lens.txt")
lens = read.table("data/vol_test/itsx_test/R1.lens.txt")
head(lens)
comb_lens = left_join(lens[c("V1","V3")], lens_mod[c("V1","V3")], by = "V1")
head(comb_lens)
ggplot(comb_lens, aes(V3.x, V3.y)) +
geom_point()
lens = read.table("data/vol_test/itsx_test/R2.lens.txt")
lens_mod = read.table("data/vol_test/itsx_mod_test/R2.lens.txt")
comb_lens = left_join(lens[c("V1","V3")], lens_mod[c("V1","V3")], by = "V1")
head(comb_lens)
ggplot(comb_lens, aes(V3.x, V3.y)) +
geom_point()
lens = read.table("data/vol_test/itsx_test/R1.lens.txt")
lens_mod = read.table("data/vol_test/itsx_mod_test/R1.lens.txt")
comb_lens = left_join(lens[c("V1","V3")], lens_mod[c("V1","V3")], by = "V1")
head(comb_lens)
ggplot(comb_lens, aes(V3.x, V3.y)) +
geom_point()
lens = read.table("data/vol_test/itsx_test/R2.lens.txt")
lens_mod = read.table("data/vol_test/itsx_mod_test/R2.lens.txt")
comb_lens = left_join(lens[c("V1","V3")], lens_mod[c("V1","V3")], by = "V1")
head(comb_lens)
ggplot(comb_lens, aes(V3.x, V3.y)) +
geom_point()
source("~/repo/BIL_pathogens/R_scripts/plot_seq_lens.R", echo=TRUE)
cor(V3.x, V3.y, data = comb_lens)
cor(comb_lens$V3.x, comb_lens$V3.y, data = comb_lens)
cor(comb_lens$V3.x, comb_lens$V3.y)
lens = read.table("data/vol_test/itsx_test/R1.lens.txt")
lens_mod = read.table("data/vol_test/itsx_mod_test/R1.lens.txt")
comb_lens = left_join(lens[c("V1","V3")], lens_mod[c("V1","V3")], by = "V1")
cor(comb_lens$V3.x, comb_lens$V3.y)
lens = read.table("data/vol_test/itsx_test/R2.lens.txt")
lens_mod = read.table("data/vol_test/itsx_mod_test/R2.lens.txt")
comb_lens = left_join(lens[c("V1","V3")], lens_mod[c("V1","V3")], by = "V1")
head(comb_lens)
cor(comb_lens$V3.x, comb_lens$V3.y)
q(save="no")
